window.storyFormat({version:"0.0.1",proofing:!1,name:"Endmatter",author:"Aaron Ross <superhawk610@gmail.com>",description:"Simple JSON export supporting YAML meta in endmatter.",source:'<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><script crossorigin src="https://unpkg.com/react@17/umd/react.production.min.js"><\/script><script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"><\/script><title>{{STORY_NAME}}</title><style type="text/css">*{box-sizing:border-box}body,html{font-family:BlinkMacSystemFont,-apple-system,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;margin:0;padding:0}#root{background:#222;color:#fff}.app{grid-gap:1rem;display:grid;grid-template-columns:250px auto;height:100vh;width:100vw}button{background:#00a1ff;border:none;border-radius:4px;cursor:pointer;font-weight:700;padding:8px 10px}button:hover{background:#0087d6}.sidebar{background:#111;flex-direction:column;gap:.5rem;justify-content:flex-start;padding:1rem}.document-container,.sidebar{align-items:stretch;display:flex}.document-container{justify-content:center;overflow-y:auto}.document-container .document{background:#333;border-radius:4px;color:#eee;font-family:Dank Mono,Fira Code,Consolas,monospace;max-width:1000px;overflow-x:auto;padding:1rem;width:100%}</style></head><body><div id="root"></div><div id="storyData" style="display: none">{{STORY_DATA}}</div><script defer="defer">(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=React;var n=e.n(t);const r=ReactDOM;var a=(0,t.createContext)({});function l(){return(0,t.useContext)(a)}function o(e,t,n){void 0===n&&(n="text/plain");var r=document.createElement("a");r.setAttribute("href","data:"+n+";charset=utf-8,"+encodeURIComponent(t)),r.setAttribute("download",e),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}function s(){var e=l(),t=e.twine,r=e.story;return n().createElement("div",{className:"sidebar"},null,n().createElement("button",{onClick:function(){return o((r.name||"story")+".json",JSON.stringify(r,null,2),"application/json")}},"Download JSON"),n().createElement("button",{onClick:function(){return o((r.name||"story")+".html",t.outerHTML,"text/html")}},"Download Twine"))}function i(){var e=l().story;return n().createElement("div",{className:"document-container"},n().createElement("div",{style:{height:"100%"}},n().createElement("div",{style:{paddingBottom:"1px"}},n().createElement("pre",{className:"document"},e?JSON.stringify(e,null,2):"Flipping pages..."))))}var c=document.getElementById("root");(0,r.render)(n().createElement(n().StrictMode,null,n().createElement((function(e){var r=e.children,l=(0,t.useState)(null),o=l[0],s=l[1],i=(0,t.useState)(null),c=i[0],u=i[1];return(0,t.useEffect)((function(){var e=document.getElementsByTagName("tw-storydata")[0];if(e){s(e);for(var t={name:e.getAttribute("name"),startNode:parseInt(e.getAttribute("startnode")),passages:[]},n=e.getElementsByTagName("tw-passagedata"),r=function(e){var n=e.innerHTML,r=[],a=void 0,l=(n=n.replace(/\\[\\[(.+?)\\]\\]/g,(function(e,t){if(t.includes("-&gt;")){var n=t.split("-&gt;"),a=n[0],l=n[1];r.push({name:a,link:l})}else r.push({name:t,link:t});return""}))).search(/\\n---\\n/);if(l>-1){var o=n.substr(l+5);n=n.substr(0,l),a={};for(var s=0,i=o.split(/\\n/g);s<i.length;s++){var c=i[s].split(":"),u=c[0],d=c[1];a[u.trim()]=d.trim()}}t.passages.push({pid:parseInt(e.getAttribute("pid")),name:e.getAttribute("name"),text:n.trim(),links:r,meta:a})},a=0,l=Array.prototype.slice.call(n);a<l.length;a++)r(l[a]);for(var o={},i=0,c=t.passages;i<c.length;i++)o[(p=c[i]).name]=p.pid;for(var d=0,m=t.passages;d<m.length;d++)for(var p,g=0,v=(p=m[d]).links;g<v.length;g++){var f=v[g];o[f.link]?f.pid=o[f.link]:f.broken=!0}u(t)}else console.log("unable to find <tw-storydata>")}),[]),n().createElement(a.Provider,{value:{twine:o,story:c}},r)}),null,n().createElement((function(){return n().createElement("div",{className:"app"},n().createElement(s,null),n().createElement(i,null))}),null))),c)})();<\/script></body></html>'});